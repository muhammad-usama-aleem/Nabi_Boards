<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Checkout</title>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.css">
  <!-- Bootstrap core CSS -->
  <link href="./css/Navbar.css" rel="stylesheet">
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="./css/checkout.css">
  <link rel="stylesheet" href="./css/footer.css">
  
</head>

<body>


  <nav class="navbar navbar-expand-custom navbar-mainbg">
  <a class="navbar-brand navbar-logo" href="#"><img src="./img/logo.png" alt="logo" width="60px" height="33px"></a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
  <i class="fas fa-bars text-white"></i>
  </button>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto">
          <div class="hori-selector"><div class="left"></div><div class="right"></div></div>
          <li class="nav-item active">
              <a class="nav-link" href="javascript:void(0);"><i class="fas fa-home"></i></i>Store</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="javascript:void(0);"><i class="fas fa-plane-departure"></i>Track Order</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="javascript:void(0);"><i class="fas fa-cart-plus"></i>Cart</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="javascript:void(0);"><i class="fas fa-phone"></i>Contact Us</a>
          </li>
          <!-- <li class="nav-item">
              <a class="nav-link" href="javascript:void(0);"><i class="far fa-chart-bar"></i>Charts</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="javascript:void(0);"><i class="far fa-copy"></i>Documents</a>
          </li> -->
      </ul>
  </div>
  </nav>



<div   class="row ">
  <div  id="summary" class="col-lg-6">
    <div class="shopping-cart">
      <!-- Title -->
      <div class="title">
        Shopping Summary
      </div>

      <!-- Product #1 -->
      <div class="item">
        
        <div class="image">
          <img src="https://designmodo.com/demo/shopping-cart/item-1.png" alt="" />
        </div>

        <div class="description">
          <span>Common Projects</span>
          <span>Bball High</span>
        </div>

        <div class="quantity">
          <p class="multiple">x1</p>
        </div>
        <div class="prices_section">
          <div class="actual">Actual Price: $50</div>
          <div class="discount">Discount: $20</div>
          <div class="total-price">Price: $549</div>
        
        </div>
        
      </div>

      <!-- Product #2 -->
      <div class="item">
        
        <div class="image">
          <img src="https://designmodo.com/demo/shopping-cart/item-2.png" alt=""/>
        </div>

        <div class="description">
          <span>Maison Margiela</span>
          <span>Future Sneakers</span>
        </div>

        <div class="quantity">
          <p class="multiple">x1</p>
        </div>
        <div class="prices_section">
          <div class="actual">Actual Price: $50</div>
          <div class="discount">Discount: $20</div>
          <div class="total-price">Price: $870</div>
        
        </div>
        
      </div>

      <!-- Product #3 -->
      <div class="item">
        
        <div class="image">
          <img src="https://designmodo.com/demo/shopping-cart/item-3.png" alt="" />
        </div>

        <div class="description">
          <span>Our Legacy</span>
          <span>Brushed Scarf</span>
        </div>

        <div class="quantity">
          <p class="multiple">x1</p>
        </div>
        <div class="prices_section">
          <div class="actual">Actual Price: $50</div>
          <div class="discount">Discount: $20</div>
          <div class="total-price">Price: $349</div>
        
        </div>
        
      </div>
    </div>
  </div>
  <!-- changeing shuja -->
  <div id="test" class="col-lg-6 form_design">
    <!-- change shuja -->
    <div class="box-element" id="form-wrapper">
      <form id="form">
        <!-- <div class="form-group">
          <label for="first">First Name</label>
          <input type="text" class="form-control" placeholder="" id="first">
        </div>

          <div class="form-group">
          <label for="first">First Name</label>
          <input type="text" class="form-control" placeholder="" id="first">
        </div>
          <hr /> -->
        </div>
        <div id="shipping-info">
          <p>Shipping Information:</p>
          <div class="form-group">
            <label for="first">First Name</label>
            <input type="text" class="form-control" placeholder="" id="first">
          </div>
          <div class="form-group">
            <label for="first">First Name</label>
            <input type="text" class="form-control" placeholder="" id="first">
          </div>
          <div class="form-group">
            <label for="first">First Name</label>
            <input type="text" class="form-control" placeholder="" id="first">
          </div>
          <div class="form-group">
            <label for="first">First Name</label>
            <input type="text" class="form-control" placeholder="" id="first">
          </div>
          <div class="form-group">
            <label for="first">First Name</label>
            <input type="text" class="form-control" placeholder="" id="first">
          </div>
          <!-- <div class="form-field">
            <input
              class="form-control"
              type="text"
              name="Phone No"
              placeholder="Phone No..."
            />
          </div> -->
        </div>
        <hr />
        <input
          id="form-button"
          class="btn btn-success btn-block"
          type="submit"
          value="Continue"
        />
      </form>
    </div>
    <div class="payment_sec">
      <div class="box-element hidden" id="payment-info">
        <small>payment Option</small>
        <!-- <button id="make-payment">Make Payment</button> -->
        <div id="paypal-button-container"></div>
      </div>
    </div>
    <br />
  </div>


  <footer class="footer_end">
    <div id="footer-parent">
        <!-- Get Help -->
        <div class="footer-item">
            <p>GET HELP</p>
            <a href="../pages/shipping/shipping.html">Shipping</a>
            <a href="../pages/warranty/warranty.html">Warranty and Return</a>
        </div>
        <!-- Get Learn More -->
        <div class="footer-item">
            <p>LEARN MORE</p>
            <a href="../pages/about/about.html">About us</a>
            <a href="../pages/payment/payment.html">Payment Option</a>
            <a href="../pages/buy/buy.html">How to Buy</a>
        </div>
        <!-- Get in Touch -->
        <div class="footer-item">
            <p>GET IN TOUCH</p>
            <a href="../pages/map/map.html">Contact us</a>
            <a href="../pages/map/map.html">Map</a>
        </div>
    </div>
    <div>
        <div id="logos-container">
            <img src="./img/Footer/paypal.svg" alt="PayPal" />
            <img src="./img/Footer/visa.svg" alt="VISA" />
            <img src="./img/Footer/stripe.svg" alt="VISA" />
            <img src="./img/Footer/dhl.svg" alt="VISA" />
            <img id="eurosender" src="./img/Footer/eurosender.png" alt="eurosender /">
            <img src="./img/Footer/dpd.svg" alt="VISA" />
            <img src="./img/Footer/mastercard.svg" alt="MasterCard" />

            
     <!--        <svg version="1.1" x="0" y="0" viewBox="0 0 95 95" enable-background="new 0 0 95 95" xml:space="preserve" preserveAspectRatio="xMinYMax meet">
                <polygon fill="#2C4486" points="57.2,4 57.2,18 68.1,18 49.1,36.9 59,46.8 79.2,26.6 79.2,40 93.2,40 93.2,4 "></polygon>
                <polygon fill="#CDCCCC" points="79.2,76 21.1,76 21.1,18 43.2,18 43.2,4 7.2,4 7.2,90 93.2,90 93.2,54 79.2,54 "></polygon>
            </svg> -->
        </div>
    </div>
    <div id="copy-right">
        <p>Â© 2019-2020 All Rights Reserved.</p>
        <a href="https://wa.me/923073386929"><img src="./img/Footer/whatsapp.svg" alt="WhatsApp" id="whatsapp" /></a>
    </div>
  </footer>


</body>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<!-- <script type="text/javascript" src="js/jquery-3.4.1.min.js"></script> -->

<script src="./js/navbar.js" type="text/javascript" ></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script src="https://www.paypal.com/sdk/js?client-id=sb&currency=USD"></script>
<script>
  // Render the PayPal button into #paypal-button-container
  var total = "{{order.get_cart_total}}";
  paypal
    .Buttons({
      style: { color: "blue", shape: "rect" },
      // Set up the transaction
      createOrder: function (data, actions) {
        return actions.order.create({
          purchase_units: [
            {
              amount: {
                value: parseFloat(total).toFixed(2),
              },
            },
          ],
        });
      },

      // Finalize the transaction
      onApprove: function (data, actions) {
        return actions.order.capture().then(function (details) {
          // Show a success message to the buyer
          submitFormData();
        });
      },
    })
    .render("#paypal-button-container");
</script>
<script type="text/javascript">
  var shipping = "{{order.shipping}}";
  var total = "{{order.get_cart_total}}";
  if (shipping == "False") {
    document.getElementById("shipping-info").innerHTML = "";
  }
  if (user != "AnonymousUser") {
    document.getElementById("user-info").innerHTML = "";
  }
  if (shipping == "False" && user != "AnonymousUser") {
    // if user is logged in and shipping is false hide the entire logged in
    document.getElementById("form-wrapper").classList.add("hidden");
    // Show if the logged in user cannot want such item which cannot be shipped
    document.getElementById("payment-info").classList.remove("hidden");
  }
  var form = document.getElementById("form");
  form.addEventListener("submit", function (e) {
    e.preventDefault();
    console.log("Form Submitted");
    document.getElementById("form-button").classList.add("hidden");
    document.getElementById("payment-info").classList.remove("hidden");
  });
  // document
  //   .getElementById("make-payment")
  //   .addEventListener("click", function (e) {
  //     submitFormData();
  //   });
  function submitFormData() {
    console.log("payment button clicked");

    var userFormData = {
      name: null,
      email: null,
      total: total,
    };
    var shippingInfo = {
      address: null,
      city: null,
      state: null,
      country: null,
      zipcode: null,
    };
    if (shipping != "False") {
      shippingInfo.address = form.address.value;
      shippingInfo.city = form.city.value;
      shippingInfo.state = form.state.value;
      shippingInfo.country = form.country.value;
      shippingInfo.zipcode = form.zipcode.value;
    }
    if (user == "AnonymousUser") {
      userFormData.name = form.name.value;
      userFormData.email = form.email.value;
    }
    var url = "/process_order/";
    fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "X-CSRFToken": csrftoken,
      },
      body: JSON.stringify({ form: userFormData, shipping: shippingInfo }),
    })
      .then((response) => response.json())
      .then((data) => {
        console.log("success: ", data);
        alert("Transaction Completed");
        cart = {};
        document.cookie = "cart=" + JSON.stringify(cart) + ";domain=;path=/";

        window.location.href = "{%url 'store'%}";
      });
  }
</script>


</body>

</html>